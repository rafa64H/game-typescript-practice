var T=Object.defineProperty;var D=(a,t,h)=>t in a?T(a,t,{enumerable:!0,configurable:!0,writable:!0,value:h}):a[t]=h;var n=(a,t,h)=>(D(a,typeof t!="symbol"?t+"":t,h),h);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function h(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(e){if(e.ep)return;e.ep=!0;const i=h(e);fetch(e.href,i)}})();class S{constructor(t,h){n(this,"canvas");n(this,"context");n(this,"width");n(this,"height");n(this,"healthBars");this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.width=1024,this.height=500,this.healthBars=h.map(s=>document.querySelector(`[${s}]`))}clear(){var t;(t=this.context)==null||t.clearRect(0,0,this.canvas.width,this.canvas.height)}create(){var t;this.canvas.width=this.width,this.canvas.height=this.height,(t=this.context)==null||t.fillRect(0,0,this.canvas.width,this.canvas.height)}reduceHealthOfSomePlayer(t,h){const s=t-1,e=this.healthBars[s];e.style.width=`${h}%`}}class k{constructor(t,h,s,e,i,o){n(this,"health");n(this,"playerSpeedX");n(this,"playerSpeedY");n(this,"movingUp");n(this,"movingRight");n(this,"movingDown");n(this,"movingLeft");n(this,"watchingToTheRight");n(this,"attacking");n(this,"attackBox");n(this,"defending");n(this,"defendBox");n(this,"recentlyReceivedHit");n(this,"handleKeyDown",t=>{t.preventDefault(),this.health>0&&((t.key==="W"||t.key==="w")&&this.player===1&&(this.movingUp=!0),(t.key==="D"||t.key==="d")&&this.player===1&&(this.movingRight=!0,this.watchingToTheRight=!0),(t.key==="S"||t.key==="s")&&this.player===1&&(this.movingDown=!0),(t.key==="A"||t.key==="a")&&this.player===1&&(this.movingLeft=!0,this.watchingToTheRight=!1),(t.key==="G"||t.key==="g")&&this.player===1&&(this.attacking=!0),(t.key==="H"||t.key==="h"&&this.player===1)&&(this.defending=!0),t.key==="ArrowUp"&&this.player===2&&(this.movingUp=!0),t.key==="ArrowRight"&&this.player===2&&(this.movingRight=!0,this.watchingToTheRight=!0),t.key==="ArrowDown"&&this.player===2&&(this.movingDown=!0),t.key==="ArrowLeft"&&this.player===2&&(this.movingLeft=!0,this.watchingToTheRight=!1),t.key==="0"&&this.player===2&&(this.attacking=!0),t.key==="."&&this.player===2&&(this.defending=!0))});n(this,"handleKeyUp",t=>{t.preventDefault(),this.health>0&&((t.key==="W"||t.key==="w")&&this.player===1&&(this.movingUp=!1),(t.key==="D"||t.key==="d")&&this.player===1&&(this.movingRight=!1),(t.key==="S"||t.key==="s")&&this.player===1&&(this.movingDown=!1),(t.key==="A"||t.key==="a")&&this.player===1&&(this.movingLeft=!1),(t.key==="G"||t.key==="g")&&this.player===1&&(this.attacking=!1),(t.key==="H"||t.key==="h"&&this.player===1)&&(this.defending=!1),t.key==="ArrowUp"&&this.player===2&&(this.movingUp=!1),t.key==="ArrowRight"&&this.player===2&&(this.movingRight=!1),t.key==="ArrowDown"&&this.player===2&&(this.movingDown=!1),t.key==="ArrowLeft"&&this.player===2&&(this.movingLeft=!1),t.key==="0"&&this.player===2&&(this.attacking=!1),t.key==="."&&this.player===2&&(this.defending=!1))});this.parentCanvas=t,this.playerPosition=h,this.playerWidth=s,this.playerHeight=e,this.playerColor=i,this.player=o,this.health=100,this.playerPosition=h,this.playerWidth=s,this.playerHeight=e,this.playerSpeedX=7,this.playerSpeedY=0,this.playerColor=i,this.movingUp=!1,this.movingRight=!1,this.movingDown=!1,this.movingLeft=!1,this.watchingToTheRight=!0,this.attacking=!1,this.attackBox={position:{x:0,y:0},widthOfAttack:0,heightOfAttack:0},this.defending=!1,this.defendBox={position:{x:0,y:0},widthOfDefend:0,heightOfDefend:0},this.recentlyReceivedHit=!1,this.player=o,document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("keyup",this.handleKeyUp)}drawPlayer(){var t,h,s,e,i,o,r;this.parentCanvas.context.fillStyle=this.playerColor,(t=this.parentCanvas.context)==null||t.fillRect(this.playerPosition.x,this.playerPosition.y,this.playerWidth,this.playerHeight),this.watchingToTheRight?(this.recentlyReceivedHit?this.parentCanvas.context.fillStyle="green":this.parentCanvas.context.fillStyle="white",(h=this.parentCanvas.context)==null||h.fillRect(this.playerPosition.x+12,this.playerPosition.y,this.playerWidth*.5,5)):(this.recentlyReceivedHit?this.parentCanvas.context.fillStyle="green":this.parentCanvas.context.fillStyle="white",(s=this.parentCanvas.context)==null||s.fillRect(this.playerPosition.x,this.playerPosition.y,this.playerWidth*.5,5)),this.watchingToTheRight&&this.attacking?(this.defending=!1,this.parentCanvas.context.fillStyle="lightblue",this.attackBox={position:{x:this.playerPosition.x+this.playerWidth,y:this.playerPosition.y+20},widthOfAttack:this.playerWidth*3,heightOfAttack:5},(e=this.parentCanvas.context)==null||e.fillRect(this.attackBox.position.x,this.attackBox.position.y,this.attackBox.widthOfAttack,this.attackBox.heightOfAttack),setTimeout(()=>{this.attacking=!1},500)):!this.watchingToTheRight&&this.attacking&&(this.defending=!1,this.parentCanvas.context.fillStyle="lightblue",this.attackBox={position:{x:this.playerPosition.x-this.playerWidth*3,y:this.playerPosition.y+20},widthOfAttack:this.playerWidth*3,heightOfAttack:5},(i=this.parentCanvas.context)==null||i.fillRect(this.attackBox.position.x,this.attackBox.position.y,this.attackBox.widthOfAttack,this.attackBox.heightOfAttack),setTimeout(()=>{this.attacking=!1},500)),this.watchingToTheRight&&this.defending?(this.parentCanvas.context.fillStyle="lightgreen",this.defendBox={position:{x:this.playerPosition.x+this.playerWidth+5,y:this.playerPosition.y},widthOfDefend:5,heightOfDefend:this.playerHeight-20},(o=this.parentCanvas.context)==null||o.fillRect(this.defendBox.position.x,this.defendBox.position.y,this.defendBox.widthOfDefend,this.defendBox.heightOfDefend)):!this.watchingToTheRight&&this.defending&&(this.parentCanvas.context.fillStyle="lightgreen",this.defendBox={position:{x:this.playerPosition.x-10,y:this.playerPosition.y},widthOfDefend:5,heightOfDefend:this.playerHeight-20},(r=this.parentCanvas.context)==null||r.fillRect(this.defendBox.position.x,this.defendBox.position.y,this.defendBox.widthOfDefend,this.defendBox.heightOfDefend))}movePlayer(){this.movingUp&&(this.playerSpeedY=-7,this.playerPosition.y+=this.playerSpeedY),this.movingRight&&(this.playerPosition.x+=this.playerSpeedX),this.movingDown&&(this.playerSpeedY+=2),this.movingLeft&&(this.playerPosition.x+=-this.playerSpeedX)}playerDie(){const t=this.playerWidth;this.playerPosition.y=this.parentCanvas.height-this.playerWidth,this.playerWidth=this.playerHeight,this.playerHeight=t}}class A{gravityOnDrawings(t,h){let s=.4;h.forEach(e=>{e.playerPosition.y<t.height-e.playerHeight?(e.playerSpeedY+=s,e.playerPosition.y+=e.playerSpeedY):e.playerSpeedY=0})}}class C{collisionOnBorders(t,h){h.forEach(s=>{const i=t.width-s.playerWidth,o=t.height-s.playerHeight,r=0;s.playerPosition.x<=r&&(s.playerPosition.x=r),s.playerPosition.x>=i&&(s.playerPosition.x=i),s.playerPosition.y<=0&&(s.playerPosition.y=0),s.playerPosition.y>=o&&(s.playerPosition.y=o)})}collisionAttack(t,h){h.forEach((s,e)=>{s.attacking&&h.forEach((i,o)=>{if(e===o)return;const r=s.attackBox.position.x,d=s.attackBox.position.y,u=s.attackBox.widthOfAttack,m=s.attackBox.heightOfAttack,y=i.playerPosition.x,p=i.playerPosition.y,R=i.playerWidth,O=i.playerHeight,g=(r<=y||r<=y+R)&&r+u>=y,v=(d<=p||d<=p+O)&&d+m>=p,B=!s.watchingToTheRight&&i.watchingToTheRight&&i.defending||s.watchingToTheRight&&!i.watchingToTheRight&&i.defending;if(!(g&&v&&B)){if(g&&v){if(i.recentlyReceivedHit)return;if(i.recentlyReceivedHit=!0,i.health-=5,t.reduceHealthOfSomePlayer(i.player,i.health),i.health<=0){i.playerDie();return}setTimeout(()=>{i.recentlyReceivedHit=!1},500)}}})})}}const l=new S("game-view",["data-health-1","data-health-2"]);l.create();const c=new k(l,{x:0,y:0},25,100,"red",1),f=new k(l,{x:500,y:0},25,100,"purple",2),P=new A,x=new C;function w(){l.clear(),l.create(),c.drawPlayer(),f.drawPlayer(),c.movePlayer(),f.movePlayer(),P.gravityOnDrawings(l,[c,f]),x.collisionOnBorders(l,[c,f]),x.collisionAttack(l,[c,f]),requestAnimationFrame(()=>{w()})}w();
